{
  "startNode": "hello",
  "title": "no use",
  "nodes": [
    {
      "id": "hello",
      "dialogs": [
        {
          "author": "character",
          "text": "911?"
        },
        {
          "author": "self",
          "text": "911. Что у вас случилось?"
        },
        {
          "author": "character",
          "text": "Топор, он хотел...аааа...."
        },
        {
          "author": "self",
          "text": "Что у вас там происходит?!!"
        },
        {
          "author": "self",
          "text": "Мы отследили ваше местоположение по GPS, вы где то в районе Никольского парка."
        }
      ],
      "actions": [
        {
          "node": "podval",
          "text": "Вы около набережной Канала Грибоедова?"
        },
        {
          "node": "garden",
          "text": "Вы в самом Никольском саду?"
        }
      ]
    },
    {
      "id": "podval",
      "activationScript": "address_position = 5;",
      "dialogs": [
        {
          "author": "",
          "text": "/*слышны крики мужчины*/"
        },
        {
          "author": "character",
          "text": "/*очень тихим голосом*/ Да, я заперлась в подземном помещении своего дома, набережная канала Грибоедова 104"
        }
      ],
      "actions": [
        {
          "node": "waiting",
          "text": "Адрес приняла, ожидайте подмогу"
        }
      ]
    },
    {
      "id": "waiting",
      "push": true,
      "dialogs": [
        {
          "author": "self",
          "text": "/*доступным службам*/ Набережная канала Грибоедова 104, женщина заперлась на нулевом этаже дома, убегая от маньяка. Подтвердите готовность"
        },
        {
          "id": "first_ambulance",
          "author": "ambulance",
          "show": "!self && service_move_in_address_ambulance > 0",
          "text": "Принято.Выезжаем"
        },
        {
          "id": "first_police",
          "author": "police",
          "show": "!self && service_move_in_address_police > 0",
          "text": "Принято.Выезжаем"
        },
        {
          "id": "first_rescuer",
          "author": "police",
          "show": "!self && service_move_in_address_police > 0",
          "text": "/*спасатели*/ Принято. Выезжаем"
        }
      ],
      "actions": [
        {
          "node": "continue_podval",
          "text": "Хорошо"
        }
      ]
    },
    {
      "id": "continue_podval",
      "dialogs": [
        {
          "author": "character",
          "text": "Давайте быстрее, Родион меня нашёл, он пытается пробить дверь топором"
        },
        {
          "author": "self",
          "text": "Спокойней, оглядитесь вокруг. Что вы видите?"
        },
        {
          "author": "character",
          "text": "Что я вижу??? Тут только подвалы"
        },
        {
          "author": "self",
          "text": "Вы можете попасть в один из них?"
        },
        {
          "author": "character",
          "text": "Да, у меня есть свой собственный подвал"
        },
        {
          "author": "self",
          "text": "Вам сейчас нужно постараться зайти в него максимально быстро и тихо"
        },
        {
          "author": "character",
          "text": "Я внутри"
        },
        {
          "author": "self",
          "text": "Хорошо, затаитесь и не издавайте никакого шума"
        }
      ],
      "actions": [
        {
          "enabled": "!weap",
          "script": "weap = 1;",
          "node": "weapon",
          "text": "Поищите чем можно защититься",
          "dialog": {
            "author": "self",
            "text": "Вам необходимо найти средство защиты. Осмотрите подвал, что вы видите?"
          }
        },
        {
           "enabled": "!heal",
           "script": "heal = 1;",
           "node": "health",
           "text": "Как ваше здоровье?"
        },
        {
           "enabled": "!cont",
           "script": "cont = 1;",
           "node": "continue",
           "text": "Алло, вы меня слышите?"
        }
      ]
    },
    {
      "id": "continue",
      "push": true,
      "dialogs": [
        {
          "author": "self",
          "text": "Вы можете рассказать, что произошло?"
        },
        {
          "author": "character",
          "text": "Родион, он принес заклад, очень туго его завязал и хотел убить меня топором пока я пыталась открыть пакет"
        },
        {
          "author": "self",
          "text": "А вы смогли увернуться?"
        },
        {
          "author": "character",
          "text": "Да, я увернулась и убежала в подвал"
        },
        {
          "author": "self",
          "text": "Как вас зовут?"
        },
        {
          "author": "character",
          "text": "Алена Ивановна"
        },
        {
          "author": "self",
          "text": "Алена Ивановна, вы упомянули имя Родион - это ваш знакомый? Вы знаете человека, который вам угрожает?"
        },
        {
          "author": "character",
          "text": " Да, это студент, он частенько ко мне заходил и закладывал свои вещи, ему постоянно нужны были деньги"
        }
      ],
      "actions": [ 
       {
          "enabled": "$service_number_of_items_police > 0 || service_move_in_address_police > 0 || service_in_address_police > 0",
          "node": "police_talk",
          "text": "Мне удалось установить личность подозреваемого",
          "dialog": {
            "author": "self",
            "text": "/*полицие*/ Офицер, мне удалось установить личность подозреваемого - некий Родион, студент 23 лет"
          }
        }  
      ]
    },
    {
      "id": "police_talk",
      "dialogs": [
        {
          "author": "police",
          "text": "Информация принята, пробьем подозреваемого по базе"
        },
        {
          "author": "police",
          "text": "Под указанное описание подходит более 100 человек"
        },   
        {
          "author": "self",
          "text": "Алёна Ивановна, вы знаете что-нибудь ещё о Родионе? Нам нужно максимально сузить поиск кандидатов"
        },
        {
          "author": "character",
          "text": "Да, я знаю что его фамилия Раскольнков"
        },
        {
          "author": "self",
          "text": "/*полицие*/ Фамилия преступника - Раскольников"
        },
        {
          "author": "police",
          "text": "Отлично, мы нашли его"
        },
        {
          "author": "police",
          "text": "Отлично, мы нашли его"
        },
        {
          "author": "",
          "text": "/*спустя некоторое время*/"
        },    
        {
          "author": "police",
          "text": "Нам удалось дозвониться до матери Родиона, после чего она связалась с сыном и убедила того сдаться. Родион ждет нас по указанному адресу без сопротивления."
        },
        {
          "author": "self",
          "text": "/*полицие*/ Спасибо за помощь, офицер!"
        },
        {
          "author": "self",
          "text": "Алёна Ивановна, вашей жизни ничего не угрожает, Родион сдался"
        }
      ],
      "actions": [
        {
          "text": "Завершить звонок",
          "endAction":  {
            "successful": false,
            "text": "Спасибо!"
          }
        }
      ]      
    },
    {
      "id": "weapon",
      "dialogs": [
        {
          "author": "character",
          "text": "Кажется, он спустился на нулевой этаж"
        },
        {
          "author": "self",
          "text": "Затаитесь, на всякий случай вам нужно вооружиться. Видите что-нибудь подходящее?"
        },
        {
          "author": "character",
          "text": "Нет, тут только растения"
        },
        {
          "author": "self",
          "text": "Что за растения у вас в подвале?"
        },
        {
          "author": "character",
          "text": "Неважно. Я нашла ножку от старого стола. Подойдёт?"
        },
        {
          "author": "self",
          "text": "Да, а сейчас постарайтесь не издавать никаких звуков"
        },
        {
          "author": "character",
          "text": "Я слышу как он начал прорубать одну дверь за другой, мне становится страшно"
        }
      ],
      "actions": [
       {
          "node": "hide",
          "text": "Затаитесь у двери",
          "dialog": {
            "author": "self",
            "text": "Затаитесь у двери, и как только он в неё войдёт попытайтесь ударить его ножкой по голове, а затем убегайте"
          }
        },
       {
          "enabled": "service_in_address_police > 0",
          "node": "police_in_place",
          "text": "Полиция уже спускается в подвал"
        }
      ]
    },
    {
      "id": "police_in_place",
      "dialogs": [
        {
          "author": "",
          "text": "/*слышны звуки крика полиции*/"
        },
        {
          "author": "police",
          "text": "Диспетчер, при предупреждении бросить топор преступник бросился на сотрудника полиции, в ответ последовало пару выстрелов. Насмерть."
        },
        {
          "author": "self",
          "text": "Алёна Ивановна, вашей жизни ничего не угрожает, преступник нейтрализован"
        }
      ],
        "actions": [
        {
          "text": "Завершить звонок",
          "endAction":  {
            "successful": false,
            "text": "Спасибо!"
          }
        }
      ]
    },
    {
      "id": "hide",
      "dialogs": [
        {
          "author": "character",
          "text": "/*слышны тяжелые вздохи*/ Встала"
        },
        {
          "author": "self",
          "text": "Он уже близко?"
        },
        {
          "author": "character",
          "text": "Да, в двух-трех дверях от меня"
        },
        {
          "author": "self",
          "text": "Приготовьтесь, сожмите крепче ножку стола"
        },
        {
          "author": "character",
          "text": "Он у двери"
        },
        {
          "author": "self",
          "text": "Ждите его действий, первой ничего не предпринимайте"
        },
        {
          "author": "",
          "text": "/*слышен звук удара дубинкой, после крики старухи*/"
        },
        {
          "author": "self",
          "text": "/*кричит в трубку телефона*/ бегите из подвала на улицу"
        },
        {
          "author": "self",
          "show": "service_in_address_police > 0",
          "text": "Полиция уже у вашего дома, бегите к ним, они вас спасут"
        },       
        {
          "author": "character",
          "show": "!service_in_address_police",
          "text": "А-а-а-а-а...помогите /*длинные гудки*/"
        }
      ],
        "actions": [
        {
          "enabled": "service_in_address_police",
          "text": "Завершить звонок",
          "endAction":  {
            "successful": true,
            "text": "Спасибо Вам!"
          }
        },
        {
          "enabled": "!service_in_address_police",
          "text": "Завершить звонок",
          "endAction":  {
            "successful": false,
            "text": "Алло..."
          }
        }
      ]
    }
  ]
}